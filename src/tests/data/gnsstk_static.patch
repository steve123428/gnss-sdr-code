SPDX-License-Identifier: GPL-3.0-or-later
SPDX-FileCopyrightText: 2022 Carles Fernandez-Prades <carles.fernandez@cttc.es>
--- CMakeLists.txt  2022-07-02 20:14:59.000000000 +0200
+++ CMakeLists.txt  2022-07-02 20:16:55.000000000 +0200
@@ -6,7 +6,7 @@
 #           Is dependend on by $GNSSTK/build.sh
 #============================================================

-cmake_minimum_required( VERSION 2.8.5 )
+cmake_minimum_required( VERSION 2.8.12 )

 project( GNSSTK )
 set( GNSSTK_VERSION_MAJOR "12" )
@@ -77,6 +77,16 @@


 include( BuildSetup.cmake )
+set(STADYN "STATIC")
+if(POLICY CMP0063)
+    cmake_policy(SET CMP0063 NEW)
+    set(CMAKE_CXX_VISIBILITY_PRESET hidden)
+    set(CMAKE_VISIBILITY_INLINES_HIDDEN 1)
+else()
+    if((CMAKE_CXX_COMPILER_ID MATCHES "Clang" OR CMAKE_CXX_COMPILER_ID STREQUAL "GNU") AND NOT WIN32)
+        add_definitions(-fvisibility=hidden)
+    endif()
+endif()

 #============================================================
 # Core Library Target Files
@@ -161,7 +171,7 @@
 add_library( gnsstk ${STADYN} ${GNSSTK_SRC_FILES} ${GNSSTK_INC_FILES} )

 # GNSSTk library install target
-install( TARGETS gnsstk DESTINATION "${CMAKE_INSTALL_LIBDIR}" EXPORT "${EXPORT_TARGETS_FILENAME}" )
+install( TARGETS gnsstk DESTINATION lib EXPORT "${EXPORT_TARGETS_FILENAME}" )

 # GNSSTk header file install target (whether it is version dependent changes based on user flag)
 install( FILES ${GNSSTK_INC_FILES} DESTINATION ${CMAKE_INSTALL_INCLUDEDIR} )
